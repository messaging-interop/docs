<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Identities - Modern Interoperable Messaging</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="architecture-overview.html">Communicator Overview</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">1.</strong> Relationship Concepts</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="authentication.html"><strong aria-hidden="true">1.1.</strong> Authentication</a></li><li class="chapter-item expanded "><a href="durability.html"><strong aria-hidden="true">1.2.</strong> Durability</a></li><li class="chapter-item expanded "><a href="principles-permission.html"><strong aria-hidden="true">1.3.</strong> Permission to Contact</a></li><li class="chapter-item expanded "><a href="interoperability.html"><strong aria-hidden="true">1.4.</strong> Interoperability</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> Technical Concepts</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="relationships.html"><strong aria-hidden="true">2.1.</strong> Relationships</a></li><li class="chapter-item expanded "><a href="groups.html"><strong aria-hidden="true">2.2.</strong> Groups</a></li><li class="chapter-item expanded "><a href="introductions.html"><strong aria-hidden="true">2.3.</strong> Introductions</a></li><li class="chapter-item expanded "><a href="identities.html" class="active"><strong aria-hidden="true">2.4.</strong> Identities</a></li><li class="chapter-item expanded "><a href="devices.html"><strong aria-hidden="true">2.5.</strong> Multiple Devices</a></li><li class="chapter-item expanded "><a href="recovery.html"><strong aria-hidden="true">2.6.</strong> Recovery</a></li><li class="chapter-item expanded "><a href="client-protocol.html"><strong aria-hidden="true">2.7.</strong> Client App Protocol</a></li></ol></li><li class="chapter-item expanded "><a href="reference-implementations.html"><strong aria-hidden="true">3.</strong> Reference Implementations</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="reference/directory-service.html"><strong aria-hidden="true">3.1.</strong> Directory Service</a></li><li class="chapter-item expanded "><a href="reference/sending-service.html"><strong aria-hidden="true">3.2.</strong> Sender's Service Agent</a></li><li class="chapter-item expanded "><a href="reference/receiving-service.html"><strong aria-hidden="true">3.3.</strong> Receiver's Service Agent</a></li></ol></li><li class="chapter-item expanded "><a href="related-work.html"><strong aria-hidden="true">4.</strong> Related Work</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Modern Interoperable Messaging</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="identities"><a class="header" href="#identities">Identities</a></h1>
<p>In this architecture, users will have many contextual identities and, will want to unify or fork those identies and the associated conversations.</p>
<p>Attestations allow people to assert relationships between cryptographic identities for which they hold the private keys. There are two kinds of attestations, with proposed implementations that require security review. Suppose there are identities A and B represented by the public keys \(A_{pk}, B_{pk}\), and corresponding private keys \(A_{sk}, B_{sk}\). Let \(Sign_{sk}(M)\) represent the signature of message \(m\) with private key \(sk\)</p>
<ul>
<li>Sequential - B follows A
<ul>
<li>Proposal: \(Sign_{B_{sk}}(B_{pk}||Sign_{A_{sk}}(B_{pk}))\)</li>
</ul>
</li>
<li>Parallel - A is equivalent to B
<ul>
<li>Proposal: \(Sign_{A_{sk}}(B_{pk})\ ||\ Sign_{B_{sk}}(A_{pk})\)</li>
</ul>
</li>
</ul>
<p>We should consider trust to be transmitted directionally in a Sequential relationship, and bidirectionally in a Parallel relationship</p>
<ul>
<li>If B follows A
<ul>
<li>I can trust B with the union of trust in A and B</li>
<li>I learn nothing new about trust in B</li>
</ul>
</li>
<li>If A is equivalent to B
<ul>
<li>I can now trust A and B with the union of trust in A and B</li>
</ul>
</li>
</ul>
<p>Messages from a key B that follows a key A should be merged chronologically with messages from A in a conversation history. Messages from a key B that is equivalent to key A should not be.</p>
<p>These attestations can be used in the following ways:</p>
<ul>
<li>Rolling keys over time
<ul>
<li>the replacement key should follow the key being replaced</li>
</ul>
</li>
<li>Linking a new identity to an existing one.
<ul>
<li>Alex and Blair met and exchanged keys \(IPK_A\) and \(IPK_B\), but Alex wants to prove they also have a attested identity \(IPK_{A_D}\) from a Directory Server
<ul>
<li>Alex should generate a new \(IPK_{A-Merged}\) and present attestations that it follows \(IPK_A\) and \(IPK_{A_D}\)</li>
</ul>
</li>
</ul>
</li>
<li>Forking threads
<ul>
<li>If Alex wants to fork a conversation they have with Blair across identities  \(IPK_A\) and \(IPK_B\), Alex can generate a new identity key \(IPK_{A'}\), and assert an equivalence between \(IPK_A\) and \(IPK_{A'}\). From Blair’s point of view, \(IPK_{A'}\) should be a new thread, inheriting whatever trust they had in \(IPK_A\)</li>
</ul>
</li>
</ul>
<h3 id="conflicts"><a class="header" href="#conflicts">Conflicts</a></h3>
<p>After issuing an attestation that B follows A, clients should delete the private key for A, and sending chain keys derived from A. (They should keep the receiving keys for some period of time). Future messages should be sent with chain keys derived from B.</p>
<p>Still, conflicts can arise if clients receive conflicting attestations that B follows A, and C follows A. These can result from software bugs, a <a href="devices.html">device with outdated state</a> , or compromise of private keys. A device with outdated state can heal its state by reaching consensus with a device with newer state about ordering of keys. E.g. by issuing an attestation that C follows B.</p>
<p>Otherwise, these conflicts must be resolved by the user. There are two cryptographic identities claiming to be Blair, which one is correct? Examples of how this might arise:</p>
<ul>
<li>Alex introduces Blair to a backup identity \(A’\) that follows \(A\).  The backup service is compromised and an attacker attempts to impersonate Alex using \(A’\). There are now two claims to Alex’s identity.
<ul>
<li>The presumption could be that a use of a backup identity A’ while A is active is fraudulent and should be assumed to be malicious. But Alex’s device might have been compromised, and is attempting to restart their relationship from a backup.</li>
<li>Technology can’t resolve this conflict - Blair has to socially resolve this conflict between the two claims to Alex’s identity, for example, by verifying keys in person</li>
</ul>
</li>
<li>An external attestation is a way of resolving this conflict.
<ul>
<li>It can also be a source of conflict. Blair has a relationship with Alex, and Alex has asserted and equivalence with the public key for @Alex on example.com's Directory Server at a point in time.</li>
<li>If example.com's Diretory publishes a new public key for \Alex on Twitter, the association is no longer valid, and we have a conflict
<ul>
<li>Alex can heal the conflict by issuing an attestation with the new public key</li>
<li>The conflict may also arise from an account takeover on the external service rather than a compromise of Alex’s device. This conflict also needs to be resolved socially.</li>
</ul>
</li>
</ul>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="introductions.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="devices.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="introductions.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="devices.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
